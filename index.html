<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Accidentes SST</title>
    <link rel="icon" href="data:image/jpeg;base64,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" type="image/png">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <div class="header-content"> 
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRnXv03BkeIZ4fLauBEN4dIqDuCPXW0sIZWLw&s" alt="Logo de la Empresa" class="header-logo">
            <h1>Dashboard de Análisis de Accidentes</h1>
        </div>
    </header>

    <nav>
        <ul>
            <li><a href="#vision-general">Visión General</a></li>
            <li><a href="#gestion-datos">Gestión de Datos</a></li>
            <li><a href="#graficos">Gráficos</a></li>
        </ul>
    </nav>

    <main>
        <section id="vision-general">
            <h2>Visión General y Estadísticas Clave 📊</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Total de Accidentes</h3>
                    <p id="totalAccidentes">0</p>
                </div>
                <div class="stat-card">
                    <h3>Accidentes con Mortalidad</h3>
                    <p id="mortalidadAccidentes">0</p>
                </div>
                <div class="stat-card">
                    <h3>Accidentes por Género (Mujer)</h3>
                    <p id="generoFemenino">0</p>
                </div>
                <div class="stat-card">
                    <h3>Accidentes por Género (Hombre)</h3>
                    <p id="generoMasculino">0</p>
                </div>
            </div>
        </section>

        <section id="gestion-datos">
            <h2>Gestión de Datos de Accidentes 📝</h2>
            <button id="abrirModalCrear" class="btn-primary">Registrar Nuevo Accidente</button>

            <div id="modalAccidente" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h3>Registro/Edición de Accidente</h3>
                    <form id="formAccidente">
                        <input type="hidden" id="accidenteId">
                        
                        <label for="fecha">Fecha:</label>
                        <input type="date" id="fecha" required>

                        <label for="nombrePersona">Nombre de la Persona:</label>
                        <input type="text" id="nombrePersona" placeholder="Nombre completo" required>

                        <label for="tipo">Tipo de Accidente:</label>
                        <select id="tipo" required>
                            <option value="">Seleccione un tipo</option>
                            <option value="Colisión">Colisión</option>
                            <option value="Atropello">Atropello</option>
                            <option value="Caída">Caída</option>
                            <option value="Quemadura">Quemadura</option>
                            <option value="Corte">Corte</option>
                            <option value="Electrocución">Electrocución</option>
                            <option value="Vuelco">Vuelco</option>
                        </select>

                        <label for="mortalidad">Mortalidad:</label>
                        <select id="mortalidad">
                            <option value="si">Sí</option>
                            <option value="no">No</option>
                        </select>

                        <label for="genero">Género:</label>
                        <select id="genero">
                            <option value="masculino">Masculino</option>
                            <option value="femenino">Femenino</option>
                            <option value="otro">Otro</option>
                        </select>

                        <label for="area">Área:</label>
                        <select id="area" required>
                            <option value="">Seleccione un área</option>
                            <option value="Sistemas">Sistemas</option>
                            <option value="Calidad">Calidad</option>
                            <option value="Planta">Planta</option>
                            <option value="Facturación">Facturación</option>
                            <option value="Contabilidad">Contabilidad</option>
                            <option value="Gerencia">Gerencia</option>
                            <option value="Administración">Administración</option>
                            <option value="Ventas">Ventas</option>
                        </select>

                        <label for="parteCuerpo">Parte del Cuerpo Afectada:</label>
                        <input type="text" id="parteCuerpo" placeholder="Ej: Mano derecha, Cabeza" required>

                        <label for="lugarAccidente">Dónde Ocurrió el Accidente:</label>
                        <input type="text" id="lugarAccidente" placeholder="Ej: Almacén, Oficina 301" required>

                        <label for="objetoLesion">Con Qué se Lesionó:</label>
                        <input type="text" id="objetoLesion" placeholder="Ej: Máquina X, Escalera" required>

                        <label for="descripcion">Descripción del Accidente:</label>
                        <textarea id="descripcion" placeholder="Detalles del accidente..." rows="4" required></textarea>

                        <button type="submit" class="btn-success">💾 Guardar Accidente</button>
                    </form>
                </div>
            </div>

            <h3>Listado de Accidentes</h3>
            <div class="filter-controls">
                <label for="filterInput">Filtrar tabla:</label>
                <input type="text" id="filterInput" placeholder="Escribe para filtrar...">
                
                <input type="file" id="importExcelInput" accept=".xlsx, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" style="display: none;">
                <button id="importExcelBtn" class="btn-secondary">⬆️ Importar desde Excel</button>
                
                <button id="exportExcelBtn" class="btn-secondary">⬇️ Exportar a Excel</button>
                <button id="exportPdfBtn" class="btn-secondary">⬇️ Exportar a PDF</button>
            </div>

            <div class="table-responsive">
                <table id="tablaAccidentes">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Fecha</th>
                            <th>Persona</th>
                            <th>Tipo</th>
                            <th>Mortalidad</th>
                            <th>Género</th>
                            <th>Área</th>
                            <th>Parte del Cuerpo</th>
                            <th>Lugar</th>
                            <th>Objeto Lesión</th>
                            <th>Descripción</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </section>

        <section id="graficos">
            <h2>Análisis Gráfico de Accidentes 📈</h2>
            <div class="charts-grid">
                <div class="chart-container">
                    <h3>Mortalidad por Accidente</h3>
                    <canvas id="chartMortalidad"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Accidentes por Género</h3>
                    <canvas id="chartGenero"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Accidentes por Área</h3>
                    <canvas id="chartArea"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Accidentes por Tipo</h3>
                    <canvas id="chartTipo"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Accidentes por Mes/Año</h3>
                    <canvas id="chartMesAnio"></canvas>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Dashboard de Accidentes</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <script src="script.js"></script>
</body>
</html>